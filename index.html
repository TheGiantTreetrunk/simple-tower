<html>
    <head>
        <title>Simple Tower</title>
        <style></style>
        <script>

        var tot_floors = 10;
        var cur_floor = 1;
        var encounter_meter = 10;
        var encounter_chance = 1;
        var gm_difficulty = 2;
        var gm_difficulty_n = ["Easy","Normal","Hard"];
        var gm_story_tracker_prog = 0;
        var gm_tower_map = [];
        
        var gm_tower_obj_0 = [];
        var gm_tower_obj_1 = [];
        var gm_tower_obj_2 = [];
        var gm_tower_obj_3 = [];

        var obj_types_id = [0,1,2];
        var obj_types_names_id = ["Nothing", "Chest", "Bag"];
        var obj_type_noise_f = [0,2,1];

        var sce_room_id = [1,2];
        var sce_room_id_n = ["Room type 1","Room type 2"]

        var obj_items_id = [0,1,2,3];
        var obj_items_names_id = ["Nothing","Item","Weapon","Utility","Special!"];
        var obj_items_perks_n = [0,2,1,2];

        var obj_weapon_id = [1,2,3];
        var obj_weapon_name_id = ["Sword","Axe","Club"];
        var obj_weapon_damage_n = [0,4,3,2];

        var ent_enemies_id = [1,2,3,4];
        var ent_enemies_name_id = ["Ghost","Snake","Glarb","Serpant"];
        var ent_enemies_damage_n = [0,2,1,3,4];
        var ent_enemies_health_n = [0,4,2,6,8];

        var player = {
            score: 0,
            max_health: 10,
            cur_health: 10,
            max_armour: 10,
            cur_armour: 10,
            cur_weapon: 0,
            has_key: 0

        };

        var enemy = {
            id: 0,
            health: 0,
            damange: 0

        };

        function start_game() {
            var x1 = document.getElementById("tower_size").value;
            var x2 = document.getElementById("difficulty").value;

            tot_floors = x1;
            gm_difficulty = x2;

            document.getElementById("output").innerHTML = "Generating Scenario. Please Wait...";
            //tower_generator
            document.getElementById("tower_generator").disabled = true;
            document.getElementById("tower_size").disabled = true;
            document.getElementById("difficulty").disabled = true;
            //const myTimeout = setTimeout(Game_Manager, 5000);
            Generate_Tower();
        }

        function Game_Manager() {//the story manager
            if(gm_story_tracker_prog == 0) {
                /*You start your adventure. this will be a basic story tracker feature....*/
                document.getElementById("output").innerHTML = "You awaken at the bottom of the pit you fell into. Dazed, and a little scuffed up you eventually come to. In front you find a ladder and a " + player.cur_weapon + " looks like the only way is up...";
            }

            if(gm_story_tracker_prog == 1) {
                /*You have found the key to progress to the final boss room*/
                document.getElementById("output").innerHTML = "As you go through the " + "compartment name" + ", you discover a mystical glowing key shimmering with power. Whereever this key leads to must be hiding something extremely valuable..."
            }

            if(gm_story_tracker_prog == 2) {
                /*You enter the final room and find the boss*/
                document.getElementById("output").innerHTML = "";
            }

            if(gm_story_tracker_prog == 3) {
                /*You defeat the final boss and discover the exit out*/
                document.getElementById("output").innerHTML = "";
            }

            if(gm_story_tracker_prog == 4) {
                /*You are defeated you lose the game!*/
                document.getElementById("output").innerHTML = "";
            }
        }

        function Generate_Tower() {
            for (var i = 0; i < tot_floors; i++) {
                /*Getting Floor Needing to generate*/
                    
                /*Roll Room Type Starts*/
                
                //roll the room type from scene room ids...
                var xx1 = Math.floor((Math.random() * sce_room_id.length));
                //push to array
                gm_tower_map.push(sce_room_id[xx1]);

                /*Roll Room Type Ends (SuPeR bAsIc!)*/

                /*Roll for Item Types Starts! (oooooooo!)*/
                
                /*Roll Item 1 type*/
                var xx2 = Math.floor((Math.random() * obj_types_id.length));
                gm_tower_obj_0.push(obj_types_names_id[xx2]);
                 
                /*Roll Item 2 type*/
                var xx3 = Math.floor((Math.random() * obj_types_id.length));
                gm_tower_obj_1.push(obj_types_names_id[xx3]);

                /*Roll Item 3 type*/
                var xx4 = Math.floor((Math.random() * obj_types_id.length));
                gm_tower_obj_2.push(obj_types_names_id[xx4]);

                /*Roll Item 4 type*/
                var xx5 = Math.floor((Math.random() * obj_types_id.length));
                gm_tower_obj_3.push(obj_types_names_id[xx5]);

                /*Roll for Item Types Ends!*/
                
            }

            /*Once Finished, change the starting room to 0 to trigger that room and the final floor to b for boss....*/
            gm_tower_map[0] = 0;
            gm_tower_obj_0[0] = obj_types_names_id[0];
            gm_tower_obj_1[0] = obj_types_names_id[0];
            gm_tower_obj_2[0] = obj_types_names_id[0];
            gm_tower_obj_3[0] = obj_types_names_id[0];
            gm_tower_map[tot_floors] = 'b';
            gm_tower_obj_0[tot_floors] = obj_types_names_id[0];
            gm_tower_obj_1[tot_floors] = obj_types_names_id[0];
            gm_tower_obj_2[tot_floors] = obj_types_names_id[0];
            gm_tower_obj_3[tot_floors] = obj_types_names_id[0];

            /*After it overrides everything, we will focus on what the player gets for a weapon as well...*/
            var yy1 = Math.floor((Math.random() * obj_weapon_id.length));
            player.cur_weapon = obj_weapon_name_id[yy1];

            /*Finally, we will exit this routine and jump into the game manager and tell it to give output and to Load the UI.*/
            gm_story_tracker_prog = 0;
            Game_Manager();
        }

        function Game_Command(com) {
            if(com == 1) {
                /*Up Command*/
                if(cur_floor != (tot_floors - 1)) {
                    cur_floor += 1;
                } else {
                    if(player.has_key == 1) {
                        cur_floor += 1;
                    } else {
                        alert("you need to find the key to enter this floor!");
                    }
                }
            }

            if(com == 2) {
                /*Down Command*/
                if(cur_floor != 0) {
                    cur_floor -= 1;
                }
            }

            if(com == 3) {
                /*Open Command*/
            }

            if(com == 4) {
                /*Smash Command*/
            }
        }

        /*Notes for project*/

        /*
        Encounters
        - normal difficulty open increases by 0.5 smashing by 1 doubles on hard, halves on easy for parameters...

        Tower Size
        - smallest is 5 largest is 50 possible

        Start Game
        - You fall into a hole during your walk into the woods. you wake up at the bottom and find a tower that might lead to the surface. you are given a random weapon to start with...

        End Game
        - You need the key and get to the top of the tower to defeat the final boss to escape.
        
        Roguelike!
        - If you die you lose the game! always will be completely randomized. 
        - eventually will need to add 'themed' rooms with specific items but thats well down the line...
        */
        </script>
    </head>
    <body>
        <h1>Simple Tower</h1>

        <div >
            Tower Size: <input type="number" id="tower_size" value="10" min="5" max="12"> (min 5 levels, max 12 levels!)
            <br>
            Difficulty: <input type="number" id="difficulty" value="2" min="1" max="3"> (lower the value the easier, higher the value the more difficult!)
            <br>
            <br>
            <button id="tower_generator" onclick="start_game()">Generate</button>
        </div>
        <h4 id="score">Score: 0</h4>
        <p id="floor">Floor: 0</p>
        <p># @ X X X X</p>
        <p id="output">text output goes here...</p>
        <button>Up</button>
        <button>Down</button>
        <button>Open</button>
        <button>Smash</button>
    </body>
</html>